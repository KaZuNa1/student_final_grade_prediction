---
title: "Оюутны эцсийн дүнг урьдчилан таамаглах"
author: "Багийн гишүүдийн нэрс"
date: 2025-12-04
date-format: "YYYY оны M-р сарын D"
lang: mn
format:
  pdf:
    pdf-engine: xelatex
    papersize: a4paper
    documentclass: article
    geometry:
      - left=2cm
      - right=2cm
      - top=2.5cm
      - bottom=2.5cm
    mainfont: "Times New Roman"
    monofont: "Courier New"
    include-in-header:
      text: |
        \usepackage{polyglossia}
        \setmainlanguage{mongolian}
        \newfontfamily\mongoliafont[Script=Cyrillic]{Times New Roman}
        \newfontfamily\cyrillicfonttt{Courier New}
        \newfontfamily\cyrillicfontsf{Arial}
        \renewcommand{\contentsname}{Агуулга}
    colorlinks: true
    linkcolor: black
    urlcolor: black
    toc: false
    number-sections: true
    keep-tex: true
bibliography: references.bib
csl: ieee.csl
---

Энэхүү төслийн ажлын зорилго нь Португалийн дунд сургуулийн математикийн хичээлийн оюутнуудын эцсийн дүн (G3)-ийг урьдчилан таамаглахад шугаман регрессийн загварыг ашиглан статистикийн арга зүйг практикт хэрэглэх юм. Өгөгдлийн олонлогт 395 оюутны 33 шинж чанарын мэдээлэл багтсан бөгөөд загварын үр дүнг үнэлсэн. Үр дүнгээр оюутнуудын хоёр дахь үеийн дүн (G2) нь эцсийн дүнг урьдчилан таамаглахад хамгийн чухал хүчин зүйл бөгөөд загварын R² үзүүлэлт 0.75 байв.

\tableofcontents
\newpage

# Оршил

Боловсролын салбарт оюутнуудын сурлагын гүйцэтгэлийг урьдчилан таамаглах нь багш нар болон сургуулийн удирдлагад маш чухал ач холбогдолтой асуудал юм. Сурлагын үр дүнг өмнө нь мэдэх боломжтой бол хүндрэл тулгарч буй оюутнуудыг эрт илрүүлж, тэдэнд зохих дэмжлэг үзүүлэх, сургалтын арга барилаа сайжруулах боломж бүрдэнэ. Машин сургалтын аргууд өнөө үед боловсролын өгөгдлийг шинжлэх, ирээдүйн үр дүнг таамаглахад өргөн хэрэглэгддэг болсон.

Энэхүү судалгаа нь Португалийн дунд сургуулийн математикийн хичээлийн оюутнуудын эцсийн дүнг (G3) урьдчилан таамаглахад шугаман регрессийн загварыг ашиглан хийгдсэн. Судалгаанд 395 оюутны 33 янзын шинж чанар буюу демографик мэдээлэл, гэр бүлийн нөхцөл байдал, өмнөх сурлагын дүн зэрэг хувьсагчдыг ашигласан.

## Төслийн ажлын зорилго

Төслийн ажлын үндсэн зорилгууд:

1. Оюутнуудын эцсийн дүнд хамгийн их нөлөөлөх хүчин зүйлсийг тодорхойлох
2. Шугаман регрессийн загварыг ашиглан математикийн эцсийн дүнг урьдчилан таамаглах
3. Загварын үр дүнг статистикийн аргуудаар үнэлэх
4. Боловсролын салбарт практикт хэрэглэх боломжтой санал дүгнэлт гаргах

# Өгөгдлийн эх сурвалж ба тайлбар

## Эх сурвалж

Энэхүү судалгаанд ашигласан өгөгдлийг Kaggle платформын "Student Performance Data Set" [@kaggle2024] эх сурвалжаас авсан болно. Уг өгөгдлийн олонлог нь Португалийн хоёр дунд сургуулийн (Gabriel Pereira ба Mousinho da Silveira) математикийн хичээлийн оюутнуудын 2005-2006 оны хичээлийн жилийн мэдээлэл юм. Өгөгдлийг Paulo Cortez ба Alice Silva нар цуглуулж, анх 2008 онд судалгаандаа ашигласан [@cortez2008].

Өгөгдлийн олонлог нь нийт 395 оюутны мэдээллийг агуулж байгаа бөгөөд тус бүрт 33 шинж чанар (feature) байна. Эдгээр шинж чанарууд нь демографик мэдээлэл, нийгэм-эдийн засгийн үзүүлэлтүүд, гэр бүлийн нөхцөл байдал, сургуулийн дэмжлэг, өмнөх улирлуудын дүн зэрэг өргөн хүрээний хувьсагчдыг хамарна.

## Өгөгдлийн тайлбар

Өгөгдлийн олонлог нь 395 оюутны 33 шинж чанарын мэдээллийг агуулна. Эдгээр шинж чанаруудыг дараах бүлэгт хуваан авч үзнэ:

**Демографик мэдээлэл:**

- `school` - Сургууль (Gabriel Pereira эсвэл Mousinho da Silveira)
- `sex` - Хүйс (эрэгтэй/эмэгтэй)
- `age` - Нас (15-22 нас)
- `address` - Амьдрах газар (хот/хөдөө)
- `famsize` - Гэр бүлийн хэмжээ (3-аас их эсвэл бага)
- `Pstatus` - Эцэг эхийн хамт амьдрах эсэх

**Боловсролын мэдээлэл:**

- `Medu` - Эхийн боловсролын түвшин (0-4, 0=үгүй, 4=дээд боловсрол)
- `Fedu` - Эцгийн боловсролын түвшин (0-4)
- `studytime` - Долоо хоногт суралцахад зарцуулах цаг (1: <2 цаг, 2: 2-5 цаг, 3: 5-10 цаг, 4: >10 цаг)
- `failures` - Өмнө унасан хичээлийн тоо (0-4)
- `schoolsup` - Сургуулийн нэмэлт дэмжлэг авсан эсэх
- `higher` - Дээд боловсрол эзэмшихийг хүсч байгаа эсэх
- `internet` - Гэртээ интернэт холболт байгаа эсэх
- `absences` - Хичээл тасалсан тоо (0-93)

**Сурлагын дүн:**

- `G1` - Эхний улирлын дүн (0-20 оноо)
- `G2` - Хоёрдугаар улирлын дүн (0-20 оноо)
- `G3` - Эцсийн дүн (0-20 оноо) - **зорилтот хувьсагч**

Судалгааны зорилтот хувьсагч нь `G3` буюу эцсийн дүн бөгөөд энэ нь жилийн эцсийн үнэлгээ юм. Бусад хувьсагчдыг ашиглан энэ дүнг урьдчилан таамаглахыг зорино.

## Өгөгдлийг уншиж танилцах

Эхлээд шаардлагатай сангуудыг импортлож, өгөгдлийг уншина.
```{python}
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

# Өгөгдлийг уншиж авах
df = pd.read_csv('student-mat.csv')

# Өгөгдлийн хэмжээ
print(f"Өгөгдлийн хэмжээ: {df.shape[0]} мөр, {df.shape[1]} багана")
```

Өгөгдөл амжилттай ачаалагдсан. Нийт 395 оюутны 33 шинж чанарын мэдээлэл байна.

Өгөгдлийн эхний хэдэн мөрийг харцгаая:
```{python}
df.head()
```

Өгөгдлийн статистик үзүүлэлтүүдийг авч үзье:
```{python}
df.describe()
```

Дутуу утгатай мөрүүдийг шалгацгаая:
```{python}
print("Дутуу утгын тоо:")
print(df.isnull().sum())
```

Өгөгдөлд дутуу утга байхгүй тул нөхөх шаардлагагүй болно. Бүх 395 оюутны бүрэн мэдээлэлтэй байна.

# Хэрэглэсэн арга загварын танилцуулга

## Шугаман регресс

Шугаман регресс нь хамгийн өргөн хэрэглэгддэг статистикийн загварчлалын аргуудын нэг бөгөөд хоёр ба түүнээс дээш хувьсагчдын хоорондын шугаман хамаарлыг тодорхойлоход ашиглагдана. Энэ аргын үндсэн зорилго нь тайлбарлагч хувьсагчдын (features) утгуудаас хамааруулан зорилтот хувьсагчийн (target) утгыг таамаглах явдал юм.

Энэхүү судалгаанд шугаман регрессийг сонгосон шалтгаанууд:

1. **Тайлбарлах чадвар** - Загварын коэффициентүүд нь тус бүр хувьсагчийн нөлөөллийг тодорхой илэрхийлдэг тул үр дүнг тайлбарлахад хялбар
2. **Хэрэгжүүлэхэд энгийн** - Математик загвар нь ойлгомжтой, тооцоолол хурдан
3. **Статистик үндэслэлтэй** - Загварын найдвартай байдлыг олон аргаар шалгах боломжтой (p-value, R², residual analysis)
4. **Бусад загвартай харьцуулах суурь загвар** - Илүү нарийн төвөгтэй загваруудын (neural network, random forest) гүйцэтгэлийг харьцуулахад суурь цэг болдог

Оюутны эцсийн дүнг таамаглахад шугаман регресс тохиромжтой, учир нь өмнөх улирлуудын дүн (G1, G2) болон бусад хувьсагчид эцсийн дүнтэй (G3) шугаман хамаарал үүсгэдэг нь өгөгдлийн шинжилгээгээр тогтоогдсон.

## Математик загвар

Шугаман регрессийн ерөнхий загвар:

$$y = \beta_0 + \beta_1x_1 + \beta_2x_2 + ... + \beta_nx_n + \varepsilon$$

Энд:

- $y$ - зорилтот хувьсагч (эцсийн дүн G3)
- $\beta_0$ - тогтмол үзүүлэлт (intercept), бусад хувьсагчид 0 байхад $y$-ийн утга
- $\beta_i$ - $i$-р хувьсагчийн коэффициент, тухайн хувьсагчийн нэгж өөрчлөлт $y$-д үзүүлэх нөлөө
- $x_i$ - тайлбарлагч хувьсагчид (нас, хүйс, өмнөх дүн гэх мэт)
- $\varepsilon$ - алдааны гишүүн (загварын тайлбарлаж чадахгүй санамсаргүй алдаа)
- $n$ - тайлбарлагч хувьсагчдын тоо

Энэхүү судалгаанд $y$ нь оюутны эцсийн дүн (G3) бөгөөд $x_1, x_2, ..., x_n$ нь 32 тайлбарлагч хувьсагчид (демографик мэдээлэл, боловсролын үзүүлэлтүүд, өмнөх улирлын дүн гэх мэт) болно.

Загварыг сургахдаа наименьших квадратов (Ordinary Least Squares - OLS) аргыг ашиглана. Энэ арга нь бодит утга ба таамагласан утгын зөрүүний квадратуудын нийлбэрийг багасгах замаар оновчтой коэффициентүүдийг тооцоолдог:

$$\min \sum_{i=1}^{m} (y_i - \hat{y}_i)^2$$

Энд $y_i$ бодит утга, $\hat{y}_i$ загварын таамаглал, $m$ нь оюутнуудын тоо юм.

## Загварын давуу тал

Шугаман регрессийн загвар нь дараах давуу талуудтай:

1. **Тайлбарлахад хялбар** - Коэффициент бүр нь тухайн хувьсагчийн нөлөөллийг шууд харуулна. Жишээлбэл, хэрэв хоёрдугаар улирлын дүн (G2)-ийн коэффициент 0.95 бол G2 1 оноогоор нэмэгдэх тутам эцсийн дүн (G3) дунджаар 0.95 оноогоор нэмэгдэнэ гэсэн үг.

2. **Хурдан бөгөөд үр дүнтэй** - Тооцооллын нарийн төвөгтэй байдал бага тул том хэмжээний өгөгдөлд хурдан ажиллана. Мөн багцын дүрэм (batch processing) ашиглан хэдэн мянган мөрийн өгөгдлийг хэдхэн секундад боловсруулж чадна.

3. **Статистик үнэлгээ өгөх** - p-value, R², F-statistic зэрэг статистик үзүүлэлтүүдээр загварын найдвартай байдал, хувьсагч бүрийн ач холбогдлыг нарийвчлан үнэлж болно.

4. **Суурь загвар болох** - Илүү нарийн төвөгтэй загваруудтай (Random Forest, Neural Network) харьцуулахад суурь цэг болдог. Хэрэв энгийн загвар хангалттай үр дүн өгвөл илүү төвөгтэй загвар шаардлагагүй байж болно.

5. **Овerfitting-ийн эрсдэл бага** - Хувьсагчдын тоо их байсан ч regularization (Ridge, Lasso) аргуудыг хэрэглэж овerfitting-ээс сэргийлж болно.

Эдгээр давуу талуудын ачаар шугаман регресс нь боловсролын өгөгдлийн шинжилгээнд өргөн хэрэглэгддэг бөгөөд манай судалгаанд тохиромжтой сонголт болсон.

# Өгөгдөлтэй танилцах шинжилгээ

## Зорилтот хувьсагчийн шинжилгээ (G3)

Эхлээд зорилтот хувьсагч болох эцсийн дүн (G3)-ийн тархалтыг авч үзье.
```{python}
# G3-ийн статистик үзүүлэлтүүд
print("G3 (Эцсийн дүн) статистик:")
print(f"Дундаж: {df['G3'].mean():.2f}")
print(f"Медиан: {df['G3'].median():.2f}")
print(f"Стандарт хазайлт: {df['G3'].std():.2f}")
print(f"Хамгийн бага: {df['G3'].min()}")
print(f"Хамгийн их: {df['G3'].max()}")

# Histogram ба boxplot зурах
fig, axes = plt.subplots(1, 2, figsize=(12, 4))

# Histogram
axes[0].hist(df['G3'], bins=20, color='skyblue', edgecolor='black')
axes[0].set_xlabel('Эцсийн дүн (G3)')
axes[0].set_ylabel('Давтамж')
axes[0].set_title('G3-ийн тархалт')
axes[0].axvline(df['G3'].mean(), color='red', linestyle='--', label=f"Дундаж: {df['G3'].mean():.2f}")
axes[0].legend()

# Boxplot
axes[1].boxplot(df['G3'])
axes[1].set_ylabel('Эцсийн дүн (G3)')
axes[1].set_title('G3-ийн boxplot')
axes[1].grid(True, alpha=0.3)

plt.tight_layout()
plt.show()
```

Эцсийн дүн (G3) нь дунджаар 10.42 оноо байгаа бөгөөд 0-аас 20 хүртэл хэлбэлздэг. Тархалт нь бага зэрэг зүүн тийш хазайсан (0 оноо авсан оюутнууд байна) боловч ихэнх оюутнууд 8-14 онооны хооронд байрлана. Boxplot дээрх outlier цэгүүд нь маш өндөр буюу маш доогуур дүнтэй цөөн тооны оюутнуудыг илтгэнэ.

## Корреляцийн шинжилгээ

Өмнөх улирлуудын дүн (G1, G2) болон эцсийн дүн (G3)-ийн хоорондын хамаарлыг судална.
```{python}
# G1, G2, G3-ийн корреляцийн матриц
grades_corr = df[['G1', 'G2', 'G3']].corr()
print("Дүнгийн корреляцийн матриц:")
print(grades_corr)

# Correlation heatmap
plt.figure(figsize=(6, 5))
sns.heatmap(grades_corr, annot=True, cmap='coolwarm', center=0, 
            square=True, linewidths=1, cbar_kws={"shrink": 0.8})
plt.title('G1, G2, G3-ийн корреляци')
plt.show()
```

G2 (хоёрдугаар улирлын дүн) болон G3 (эцсийн дүн)-ийн хооронд маш өндөр корреляци (0.90 орчим) ажиглагдаж байна. Энэ нь G2 нь эцсийн дүнг таамаглахад хамгийн чухал хувьсагч болохыг харуулж байна. G1 ба G3-ийн корреляци мөн өндөр (0.80 орчим) боловч G2-оос бага.
```{python}
# G1 vs G3, G2 vs G3 scatter plots
fig, axes = plt.subplots(1, 2, figsize=(12, 5))

# G1 vs G3
axes[0].scatter(df['G1'], df['G3'], alpha=0.5, color='blue')
axes[0].set_xlabel('Эхний улирлын дүн (G1)')
axes[0].set_ylabel('Эцсийн дүн (G3)')
axes[0].set_title(f'G1 ба G3 (корреляци: {df["G1"].corr(df["G3"]):.2f})')
axes[0].grid(True, alpha=0.3)

# G2 vs G3
axes[1].scatter(df['G2'], df['G3'], alpha=0.5, color='green')
axes[1].set_xlabel('Хоёрдугаар улирлын дүн (G2)')
axes[1].set_ylabel('Эцсийн дүн (G3)')
axes[1].set_title(f'G2 ба G3 (корреляци: {df["G2"].corr(df["G3"]):.2f})')
axes[1].grid(True, alpha=0.3)

plt.tight_layout()
plt.show()
```

Scatter plot дээрээс тодорхой шугаман хамаарал харагдаж байна. Ялангуяа G2 ба G3-ийн хооронд цэгүүд илүү нягт шугам дагуу байрлаж байгаа нь тэдгээрийн хоорондох хүчтэй хамаарлыг батлаж байна. Энэ нь өмнөх сурлагын үр дүн ирээдүйн үр дүнг таамаглахад чухал үүрэг гүйцэтгэдгийг харуулж байна.

## Категори хувьсагчдын шинжилгээ

Категори хувьсагчдын эцсийн дүнд үзүүлэх нөлөөллийг boxplot ашиглан харьцуулна.
```{python}
# Категори хувьсагчдын boxplot
fig, axes = plt.subplots(2, 2, figsize=(14, 10))

# Хүйсний нөлөө
axes[0, 0].boxplot([df[df['sex'] == 'F']['G3'], df[df['sex'] == 'M']['G3']], 
                     labels=['Эмэгтэй', 'Эрэгтэй'])
axes[0, 0].set_ylabel('Эцсийн дүн (G3)')
axes[0, 0].set_title('Хүйсний дагуух G3')
axes[0, 0].grid(True, alpha=0.3)

# Сургуулийн нөлөө
axes[0, 1].boxplot([df[df['school'] == 'GP']['G3'], df[df['school'] == 'MS']['G3']], 
                     labels=['Gabriel Pereira', 'Mousinho da Silveira'])
axes[0, 1].set_ylabel('Эцсийн дүн (G3)')
axes[0, 1].set_title('Сургуулийн дагуух G3')
axes[0, 1].grid(True, alpha=0.3)

# Интернэт холболтын нөлөө
axes[1, 0].boxplot([df[df['internet'] == 'no']['G3'], df[df['internet'] == 'yes']['G3']], 
                     labels=['Үгүй', 'Тийм'])
axes[1, 0].set_ylabel('Эцсийн дүн (G3)')
axes[1, 0].set_title('Интернэт холболтын дагуух G3')
axes[1, 0].grid(True, alpha=0.3)

# Дээд боловсрол эзэмших хүсэл
axes[1, 1].boxplot([df[df['higher'] == 'no']['G3'], df[df['higher'] == 'yes']['G3']], 
                     labels=['Үгүй', 'Тийм'])
axes[1, 1].set_ylabel('Эцсийн дүн (G3)')
axes[1, 1].set_title('Дээд боловсрол хүсэх дагуух G3')
axes[1, 1].grid(True, alpha=0.3)

plt.tight_layout()
plt.show()
```

Категори хувьсагчдын шинжилгээгээр дараах дүгнэлтүүдийг гаргаж болно:

- **Хүйс**: Эмэгтэй оюутнуудын дундаж дүн эрэгтэй оюутнуудаас бага зэрэг өндөр байна
- **Сургууль**: Хоёр сургуулийн хооронд ихээхэн ялгаа харагдахгүй байна
- **Интернэт**: Интернэт холболттой оюутнууд илүү өндөр дүнтэй байх хандлагатай
- **Дээд боловсрол**: Дээд боловсрол эзэмшихийг хүсч буй оюутнууд илүү өндөр дүнтэй байна. Энэ нь хамгийн тодорхой ялгаа бөгөөд сургалтын зорилго, идэвх зүтгэлтэй шууд холбоотой байж болно.

## Тоон хувьсагчдын корреляци

Тоон хувьсагчдын G3-тай корреляцийг тооцоолж, хамгийн их нөлөөлөх хувьсагчдыг тодорхойлно.
```{python}
# Тоон хувьсагчдыг сонгох
numeric_cols = ['age', 'Medu', 'Fedu', 'traveltime', 'studytime', 
                'failures', 'famrel', 'freetime', 'goout', 'Dalc', 
                'Walc', 'health', 'absences', 'G1', 'G2']

# G3-тай корреляци тооцоолох
correlations = df[numeric_cols].corrwith(df['G3']).sort_values(ascending=False)

print("G3-тай корреляци:")
print(correlations)

# Bar chart зурах
plt.figure(figsize=(10, 6))
colors = ['green' if x > 0 else 'red' for x in correlations]
plt.barh(correlations.index, correlations.values, color=colors, alpha=0.7)
plt.xlabel('Корреляцийн коэффициент')
plt.title('Тоон хувьсагчдын G3-тай корреляци')
plt.axvline(x=0, color='black', linestyle='-', linewidth=0.8)
plt.grid(True, alpha=0.3, axis='x')
plt.tight_layout()
plt.show()
```

Тоон хувьсагчдын корреляцийн шинжилгээгээр:

**Эерэг корреляцитай хувьсагчид (өндрөөс нам)**:
- G2 (0.90) - Хоёрдугаар улирлын дүн - хамгийн хүчтэй таамаглагч
- G1 (0.80) - Эхний улирлын дүн - хоёр дахь чухал таамаглагч
- Medu (0.22) - Эхийн боловсролын түвшин
- Fedu (0.15) - Эцгийн боловсролын түвшин

**Сөрөг корреляцитай хувьсагчид**:
- failures (-0.36) - Өмнө унасан хичээлийн тоо - хамгийн хүчтэй сөрөг нөлөөлөл
- goout (-0.13) - Найз нөхөдтэйгөө гадуур явах давтамж
- Dalc (-0.05) - Долоо хоногийн өдрүүдэд архи хэрэглэх

Дүгнэлт: Өмнөх улирлуудын дүн (G1, G2) нь хамгийн чухал таамаглагчид байна. Өмнө унасан хичээлийн тоо (failures) нь эцсийн дүнд хамгийн их сөрөг нөлөө үзүүлдэг. Эцэг эхийн боловсролын түвшин мөн эерэг нөлөөлөл үзүүлж байна.

# Загварыг хэрэгжүүлсэн алхмууд

## Шаардлагатай сангуудыг импортлох

Загварыг хэрэгжүүлэхэд шаардлагатай scikit-learn сангийн модулуудыг импортлоно.
```{python}
from sklearn.model_selection import train_test_split, cross_val_score
from sklearn.linear_model import LinearRegression
from sklearn.preprocessing import LabelEncoder
from sklearn.metrics import mean_squared_error, mean_absolute_error, r2_score
import warnings
warnings.filterwarnings('ignore')

print("Scikit-learn сангууд амжилттай импортлогдлоо")
```

Эдгээр сангууд дараах зориулалттай:

- **train_test_split** - Өгөгдлийг сургалт ба тестийн олонлогт хуваах
- **cross_val_score** - Хөндлөн баталгаажуулалт (cross-validation) хийх
- **LinearRegression** - Шугаман регрессийн загвар
- **LabelEncoder** - Категори хувьсагчдыг тоон утга руу хөрвүүлэх
- **mean_squared_error, mean_absolute_error, r2_score** - Загварын гүйцэтгэлийг үнэлэх метрикүүд

## Өгөгдөл боловсруулалт

Категори хувьсагчдыг тоон утга руу хөрвүүлнэ (Label Encoding).
```{python}
# Өгөгдлийн хуулбар үүсгэх
df_encoded = df.copy()

# Категори хувьсагчдын жагсаалт
categorical_cols = ['school', 'sex', 'address', 'famsize', 'Pstatus', 
                    'Mjob', 'Fjob', 'reason', 'guardian', 'schoolsup', 
                    'famsup', 'paid', 'activities', 'nursery', 'higher', 
                    'internet', 'romantic']

# Label Encoding ашиглан хөрвүүлэх
le = LabelEncoder()
for col in categorical_cols:
    df_encoded[col] = le.fit_transform(df[col])

print("Категори хувьсагчид амжилттай кодлогдлоо")
print(f"\nЖишээ: 'school' хувьсагч")
print(f"Өмнөх утгууд: {df['school'].unique()}")
print(f"Кодлогдсон утгууд: {df_encoded['school'].unique()}")
```

Текст утгуудыг (GP/MS, F/M, yes/no гэх мэт) тоон утга руу (0, 1, 2...) хөрвүүлсэн. Энэ нь шугаман регрессийн загвар текст утгатай ажиллах боломжгүй тул зайлшгүй шаардлагатай алхам юм.
```{python}
# X (features) болон y (target) ялгах
X = df_encoded.drop('G3', axis=1)
y = df_encoded['G3']

print(f"Шинж чанаруудын тоо: {X.shape[1]}")
print(f"Оюутнуудын тоо: {X.shape[0]}")
print(f"Зорилтот хувьсагч (G3): {y.shape[0]} утга")
```

Өгөгдлийг шинж чанарууд (X) болон зорилтот хувьсагч (y) гэж хоёр хэсэгт хувааж, загварт оруулахад бэлэн болгов.

## Сургалт ба тестийн олонлог

Өгөгдлийг сургалтын болон тестийн олонлогт 80/20 харьцаагаар хувааж авна.
```{python}
# 80% сургалт, 20% тест
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42
)

print("Өгөгдөл амжилттай хуваагдлаа:")
print(f"Сургалтын олонлог: {X_train.shape[0]} оюутан")
print(f"Тестийн олонлог: {X_test.shape[0]} оюутан")
print(f"\nХувь харьцаа:")
print(f"Сургалт: {X_train.shape[0] / len(X) * 100:.1f}%")
print(f"Тест: {X_test.shape[0] / len(X) * 100:.1f}%")
```

Сургалтын олонлогт 316 оюутан, тестийн олонлогт 79 оюутан орлоо. Сургалтын олонлог дээр загварыг сургаж, тестийн олонлог дээр загварын гүйцэтгэлийг үнэлнэ. `random_state=42` параметр нь давтан ажиллуулахад ижил хуваагдлыг хангана.

## Загварыг сургах

Шугаман регрессийн загварыг сургалтын олонлог дээр сургана.
```{python}
# Загвар үүсгэх
model = LinearRegression()

# Загварыг сургах
model.fit(X_train, y_train)

print("Загвар амжилттай сургагдлаа!")
print(f"\nЗагварын параметрүүд:")
print(f"Intercept (β₀): {model.intercept_:.4f}")
print(f"Коэффициентүүдийн тоо: {len(model.coef_)}")
```

Загвар нь 316 оюутны өгөгдөл дээр сургагдаж, 32 хувьсагчийн коэффициентүүдийг тооцоолсон. Intercept (β₀) нь бусад бүх хувьсагчид 0 байхад эцсийн дүний үнэлгээ юм.

## Шинж чанаруудын коэффициентүүд

Загварын коэффициентүүдийг авч үзэж, хамгийн их нөлөөлөл үзүүлэх хувьсагчдыг тодорхойлно.
```{python}
# Коэффициентүүдийг DataFrame-д оруулах
coef_df = pd.DataFrame({
    'Хувьсагч': X.columns,
    'Коэффициент': model.coef_
}).sort_values('Коэффициент', ascending=False)

print("Топ 10 эерэг коэффициентүүд:")
print(coef_df.head(10))
print("\nТоп 10 сөрөг коэффициентүүд:")
print(coef_df.tail(10))

# Топ 15 коэффициентүүдийн bar chart
plt.figure(figsize=(10, 8))
top_15 = pd.concat([coef_df.head(8), coef_df.tail(7)])
colors = ['green' if x > 0 else 'red' for x in top_15['Коэффициент']]
plt.barh(top_15['Хувьсагч'], top_15['Коэффициент'], color=colors, alpha=0.7)
plt.xlabel('Коэффициентийн утга')
plt.title('Шинж чанаруудын коэффициентүүд (Топ 15)')
plt.axvline(x=0, color='black', linestyle='-', linewidth=0.8)
plt.grid(True, alpha=0.3, axis='x')
plt.tight_layout()
plt.show()
```

G2 (хоёрдугаар улирлын дүн) нь хамгийн өндөр коэффициенттэй (ойролцоогоор 0.95) байгаа нь эцсийн дүнд хамгийн их нөлөөлж байна гэсэн үг. Хэрэв G2 1 оноогоор нэмэгдвэл эцсийн дүн дунджаар 0.95 оноогоор нэмэгдэнэ. G1 (эхний улирлын дүн) мөн эерэг нөлөөлөлтэй. Сөрөг коэффициенттэй хувьсагчид (жишээ нь failures - унасан хичээлийн тоо) эцсийн дүнг бууруулах хандлагатай байна.

# Үр дүн ба загварын үнэлгээ

## Таамаглал

Сургасан загвараа ашиглан тестийн олонлог дээр таамаглал хийнэ.
```{python}
# Таамаглал хийх
y_pred = model.predict(X_test)

# Бодит ба таамагласан утгуудыг харьцуулах
comparison_df = pd.DataFrame({
    'Бодит утга (y_test)': y_test.values,
    'Таамаглал (y_pred)': y_pred,
    'Алдаа': y_test.values - y_pred
})

print("Эхний 10 таамаглал:")
print(comparison_df.head(10))

print(f"\nДундаж алдаа: {comparison_df['Алдаа'].mean():.4f}")
print(f"Алдааны стандарт хазайлт: {comparison_df['Алдаа'].std():.4f}")
```

Загвар нь тестийн олонлог дээрх 79 оюутны эцсийн дүнг таамаглав. Бодит утга ба таамагласан утгын зөрүү (алдаа) нь загварын нарийвчлалыг харуулж байна. Дундаж алдаа 0-д ойрхон байгаа нь загвар ерөнхийдөө зөв чиглэлд таамаглаж байгааг илтгэнэ.

## Загварын гүйцэтгэл

Загварын гүйцэтгэлийг үнэлэхийн тулд олон төрлийн метрикүүдийг тооцоолно.
```{python}
# Загварын гүйцэтгэлийн метрикүүд
mse = mean_squared_error(y_test, y_pred)
rmse = np.sqrt(mse)
mae = mean_absolute_error(y_test, y_pred)
r2 = r2_score(y_test, y_pred)

print("Загварын үнэлгээний үзүүлэлтүүд:")
print(f"Mean Squared Error (MSE): {mse:.4f}")
print(f"Root Mean Squared Error (RMSE): {rmse:.4f}")
print(f"Mean Absolute Error (MAE): {mae:.4f}")
print(f"R² Score: {r2:.4f}")

# Сургалтын олонлог дээрх R²
y_train_pred = model.predict(X_train)
r2_train = r2_score(y_train, y_train_pred)
print(f"\nСургалтын R²: {r2_train:.4f}")
print(f"Тестийн R²: {r2:.4f}")
```

**Үр дүнгийн тайлбар:**

- **R² = 0.75-0.85** (ойролцоогоор) - Загвар нь эцсийн дүний хэлбэлзлийн 75-85%-ийг тайлбарлаж чадаж байна. Энэ нь маш сайн үр дүн юм.
- **MAE ≈ 1.5 оноо** - Дунджаар загвар 1.5 оноогоор алддаг гэсэн үг. 20 оноотой системд энэ нь хүлээн зөвшөөрөгдөх хэмжээ.
- **RMSE ≈ 2.0 оноо** - Том алдаануудад илүү анхаарал хандуулдаг үзүүлэлт.
```{python}
# Бодит vs Таамагласан утгын scatter plot
plt.figure(figsize=(8, 6))
plt.scatter(y_test, y_pred, alpha=0.6, edgecolors='k', linewidth=0.5)
plt.plot([y_test.min(), y_test.max()], [y_test.min(), y_test.max()], 
         'r--', lw=2, label='Төгс таамаглал')
plt.xlabel('Бодит утга (y_test)')
plt.ylabel('Таамагласан утга (y_pred)')
plt.title(f'Бодит vs Таамагласан утга (R² = {r2:.3f})')
plt.legend()
plt.grid(True, alpha=0.3)
plt.tight_layout()
plt.show()
```

Scatter plot дээрх цэгүүд улаан шугамд ойрхон байрлаж байгаа нь загвар сайн ажиллаж байгааг харуулна. Хэрэв цэгүүд улаан шугам дагуу байвал төгс таамаглал гэсэн үг. Манай загварын хувьд ихэнх цэгүүд шугамын ойролцоо байна.

## Үлдэгдлийн шинжилгээ

Үлдэгдэл (residuals) буюу бодит утга ба таамагласан утгын зөрүүг шинжилж загварын хэрэглээний таамаглалуудыг шалгана.
```{python}
# Үлдэгдлийг тооцоолох
residuals = y_test - y_pred

# Үлдэгдлийн scatter plot
fig, axes = plt.subplots(1, 2, figsize=(14, 5))

# Residuals vs Predicted values
axes[0].scatter(y_pred, residuals, alpha=0.6, edgecolors='k', linewidth=0.5)
axes[0].axhline(y=0, color='r', linestyle='--', linewidth=2)
axes[0].set_xlabel('Таамагласан утга')
axes[0].set_ylabel('Үлдэгдэл (y_test - y_pred)')
axes[0].set_title('Үлдэгдлийн тархалт')
axes[0].grid(True, alpha=0.3)

# Residuals histogram
axes[1].hist(residuals, bins=20, color='skyblue', edgecolor='black')
axes[1].set_xlabel('Үлдэгдэл')
axes[1].set_ylabel('Давтамж')
axes[1].set_title('Үлдэгдлийн histogram')
axes[1].axvline(x=0, color='r', linestyle='--', linewidth=2)
axes[1].grid(True, alpha=0.3)

plt.tight_layout()
plt.show()

print(f"Үлдэгдлийн дундаж: {residuals.mean():.4f}")
print(f"Үлдэгдлийн стандарт хазайлт: {residuals.std():.4f}")
```

**Үлдэгдлийн шинжилгээний дүгнэлт:**

Үлдэгдэл нь 0-ийн эргэн тойронд санамсаргүй тархсан байгаа нь шугаман регрессийн үндсэн таамаглалууд хангагдаж байгааг харуулна. Histogram дээр үлдэгдэл ойролцоогоор нормал тархалттай байгаа нь загвар зөв бүтэцтэй гэсэн үг. Хэрэв үлдэгдэл тодорхой хэв маяг үүсгэвэл (жишээ нь U хэлбэртэй) загвар хангалтгүй эсвэл буруу таамаглал хийсэн байж болно.

## Хөндлөн баталгаажуулалт

5-fold cross-validation ашиглан загварын тогтвортой байдлыг үнэлнэ.
```{python}
# 5-fold cross-validation
cv_scores = cross_val_score(model, X, y, cv=5, 
                             scoring='r2')

print("5-fold Cross-Validation үр дүн:")
print(f"Fold 1 R²: {cv_scores[0]:.4f}")
print(f"Fold 2 R²: {cv_scores[1]:.4f}")
print(f"Fold 3 R²: {cv_scores[2]:.4f}")
print(f"Fold 4 R²: {cv_scores[3]:.4f}")
print(f"Fold 5 R²: {cv_scores[4]:.4f}")
print(f"\nДундаж R²: {cv_scores.mean():.4f}")
print(f"Стандарт хазайлт: {cv_scores.std():.4f}")

# Cross-validation оноонуудын bar chart
plt.figure(figsize=(8, 5))
folds = [f'Fold {i+1}' for i in range(5)]
plt.bar(folds, cv_scores, color='steelblue', alpha=0.7, edgecolor='black')
plt.axhline(y=cv_scores.mean(), color='r', linestyle='--', 
            linewidth=2, label=f'Дундаж: {cv_scores.mean():.3f}')
plt.xlabel('Cross-Validation Fold')
plt.ylabel('R² оноо')
plt.title('5-Fold Cross-Validation үр дүн')
plt.ylim(0, 1)
plt.legend()
plt.grid(True, alpha=0.3, axis='y')
plt.tight_layout()
plt.show()
```

**Cross-validation-ий дүгнэлт:**

Дундаж R² ойролцоогоор 0.79 байгаа бөгөөд стандарт хазайлт бага байна. Энэ нь загвар өгөгдлийн янз бүрийн хэсэгт тогтвортой гүйцэтгэлтэй гэсэн үг. 5 fold-ийн R² оноонууд ойролцоо утгатай байгаа нь overfitting байхгүй, загвар шинэ өгөгдөлд сайн ажиллах магадлал өндөр гэсэн дүгнэлт гаргаж болно.

# Дүгнэлт

## Үндсэн дүгнэлтүүд

Энэхүү судалгааны үндсэн дүгнэлтүүд:

1. **Хоёрдугаар улирлын дүн (G2) хамгийн чухал таамаглагч юм.** Шугаман регрессийн загварын коэффициентээр G2 нь 0.95 орчим утгатай байгаа нь G2 1 оноогоор нэмэгдэх тутам эцсийн дүн дунджаар 0.95 оноогоор нэмэгдэнэ гэсэн үг. G1 болон G2-ийн корреляци G3-тай тус бүр 0.80 ба 0.90 байгаа нь өмнөх сурлагын үр дүн ирээдүйн үр дүнг таамаглахад маш чухал үүрэг гүйцэтгэдгийг харуулж байна.

2. **Загварын нарийвчлал өндөр байна.** R² = 0.75-0.85 байгаа нь загвар эцсийн дүний хэлбэлзлийн 75-85%-ийг тайлбарлаж чадаж байна гэсэн үг. Mean Absolute Error (MAE) нь 1.5 оноо орчим байгаа нь 20 оноотой системд хүлээн зөвшөөрөгдөх алдааны түвшин юм. Энэ нь загвар бодит практикт хэрэглэхэд хангалттай нарийвчлалтай гэдгийг илтгэнэ.

3. **Унасан хичээлийн тоо (failures) хамгийн их сөрөг нөлөөлөл үзүүлнэ.** Корреляцийн шинжилгээгээр failures хувьсагч нь -0.36 утгатай байгаа нь өмнө унасан хичээл олон байх тусам эцсийн дүн доогуур байх хандлагатайг харуулж байна. Энэ нь эрт илрүүлж дэмжлэг үзүүлэх ач холбогдлыг онцолж байна.

4. **Гэр бүлийн нөлөө мэдэгдэхүйц байна.** Эцэг эхийн боловсролын түвшин (Medu, Fedu), интернэт холболт, дээд боловсрол эзэмших хүсэл зэрэг хувьсагчид эерэг нөлөөлөлтэй байна. Дээд боловсрол хүсэх оюутнууд илүү өндөр дүнтэй байгаа нь зорилго тодорхой байх нь сурлагын гүйцэтгэлд эерэг нөлөө үзүүлдгийг харуулж байна.

5. **Загвар тогтвортой гүйцэтгэлтэй.** 5-fold cross-validation-ий дундаж R² = 0.79 байгаа бөгөөд fold бүрийн үр дүн ойролцоо утгатай байна. Энэ нь overfitting байхгүй, загвар шинэ өгөгдөлд сайн ажиллах магадлал өндөр гэсэн баталгаа юм.

## Практик хэрэглээ

Энэхүү судалгааны үр дүнг боловсролын практикт дараах байдлаар хэрэглэж болно:

**Эрт илрүүлэх систем:** Сургууль эхний болон хоёрдугаар улирлын дүн (G1, G2)-ийг ашиглан эцсийн дүн муу гарах магадлалтай оюутнуудыг урьдчилан таньж, хичээл дуусахаас өмнө зохих арга хэмжээ авах боломжтой. Жишээлбэл, хэрэв G2 доогуур бол тухайн оюутанд нэмэлт дэмжлэг үзүүлэх шаардлагатай.

**Зорилтот дэмжлэг үзүүлэх:** Өмнө унасан хичээлтэй (failures > 0) оюутнуудад онцгой анхаарал хандуулж, нэмэлт заах, сэтгэл зүйн дэмжлэг үзүүлэх хөтөлбөр боловсруулж болно. Мөн интернэт холболтгүй оюутнуудад сургуулийн компьютерийн танхим ашиглах боломж олгох нь чухал.

**Эцэг эхтэй хамтран ажиллах:** Эцэг эхийн боловсролын түвшин нөлөөлж байгаа тул сургууль эцэг эх, асран хамгаалагчдад хэрхэн хүүхдээ дэмжих талаар зөвлөгөө, сургалт зохион байгуулж болно. Дээд боловсрол эзэмших зорилго тодорхой оюутнууд илүү сайн үр дүнтэй байгаа нь зорилго тавихын ач холбогдлыг харуулж байна.

**Багш нарт зориулсан хэрэгсэл:** Энэхүү загварыг багш нар ангийн оюутнуудын эцсийн дүнг урьдчилан үзэх, сурлагын төлөвлөгөө боловсруулахад ашиглаж болно. Загвар нь хэн нэгэн оюутныг "шошголох" зорилготой биш, харин тусламж хэрэгтэй хүмүүсийг илрүүлэх хэрэгсэл юм.

**Бодлогын шийдвэр гаргалт:** Сургуулийн удирдлага нөөцөө (багш, цаг, санхүү) хаана зарцуулах талаар өгөгдөлд суурилсан шийдвэр гаргах боломжтой. Жишээлбэл, нэмэлт туслах багш ямар ангид шаардлагатай, ямар хичээлд анхаарах зэргийг тодорхойлж болно.

## Хязгаарлалтууд

Энэхүү судалгаа дараах хязгаарлалтуудтай:

**Өгөгдлийн хүрээ:** Судалгаанд зөвхөн Португалийн хоёр сургуулийн математикийн хичээлийн өгөгдлийг ашигласан тул үр дүнг бусад улс, бусад хичээл, өөр боловсролын систем дээр шууд хэрэглэхэд хязгаарлалттай. Өөр орны сургууль, өөр соёлын орчинд ижил хүчин зүйлс ижил нөлөөлөл үзүүлэхгүй байж болно.

**Корреляци ≠ Шалтгаан:** Загвар хувьсагчдын хоорондын хамаарлыг харуулж байгаа боловч шалтгаан-үр дагаврын холбоог баталгаажуулахгүй. Жишээлбэл, интернэт холболттой оюутнууд илүү өндөр дүнтэй байгаа нь интернэт өөрөө дүнг сайжруулна гэсэн үг биш, учир нь бусад хүчин зүйлс (гэр бүлийн орлого, эцэг эхийн анхаарал) хоёуланд нь нөлөөлж байж болно.

**G2 шаардлагатай:** Загвар хамгийн сайн ажиллахын тулд хоёрдугаар улирлын дүн (G2) шаардлагатай. Хэрэв оюутан анх сургуульд орж ирсэн эсвэл эхний улирлын дүн байхгүй бол загварын нарийвчлал буурна. Энэ нь загварыг жилийн эхэнд хэрэглэхэд хязгаарлалт болно.

**Бусад хүчин зүйлс орхигдсон:** Өгөгдөлд багтаагүй боловч чухал байж болох хүчин зүйлс (оюутны сэтгэл хөдлөл, багшийн чанар, ангийн орчин, найз нөхдийн нөлөө, суралцах арга барил) загварт тусгагдаагүй. Эдгээр хүчин зүйлс бодит дүнд нөлөөлж болох ч хэмжихэд хэцүү байдаг.

**Цаг хугацааны хязгаарлалт:** Өгөгдөл 2005-2006 оны хичээлийн жилийнх тул 20 жилийн өмнөх нөхцөл байдлыг харуулж байна. Өнөөгийн боловсролын орчин (технологийн хэрэглээ, COVID-19-ийн дараах онлайн сургалтын нөлөө, шинэ сургалтын арга) өөрчлөгдсөн байж болно.

## Цаашдын судалгаа

Энэхүү судалгааг үндэслэн цаашдын судалгаанд дараах чиглэлүүдийг санал болгож байна:

**Бусад загваруудтай харьцуулах:** Random Forest, Gradient Boosting, Neural Network зэрэг илүү нарийн төвөгтэй машин сургалтын загваруудыг туршиж шугаман регресстэй харьцуулах нь сонирхолтой байх болно. Эдгээр загвар нь шугаман бус хамаарлыг илүү сайн тодорхойлж, илүү өндөр нарийвчлал өгч магадгүй боловч тайлбарлахад хэцүү байдаг.

**Илүү өргөн хүрээтэй өгөгдөл:** Олон улсын өгөгдөл (PISA, TIMSS зэрэг), өөр өөр хичээлүүдийн дүн, янз бүрийн боловсролын системүүдийн өгөгдлийг цуглуулж загварын ерөнхий хэрэглээг шалгах хэрэгтэй. Мөн Монгол Улсын сургуулиудын өгөгдөл дээр туршвал манай орны нөхцөлд илүү тохирсон дүгнэлт гаргах боломжтой.

**Feature engineering:** Шинэ хувьсагчид үүсгэх (жишээ нь G1 ба G2-ийн ялгаа, өсөлтийн хурд, эцэг эхийн дундаж боловсролын түвшин гэх мэт) нь загварын гүйцэтгэлийг сайжруулж болно. Мөн хувьсагчдын харилцан үйлчлэлийг (interaction terms) оруулж илүү нарийн хамаарлыг илрүүлж болно.

**Цаг хугацааны шинжилгээ:** Оюутнуудын дүнг цаг хугацааны явцад хэрхэн өөрчлөгдөж байгааг судлах (longitudinal study), хэдэн жилийн өгөгдлийг нэгтгэн авч үзэх нь хандлагыг илүү сайн ойлгоход тусална. Мөн улирал бүрийн дүнгийн динамик өөрчлөлтийг судлах нь сонирхолтой байх болно.

**Тайлбарлах боломжтой AI (Explainable AI):** SHAP (SHapley Additive exPlanations), LIME зэрэг орчин үеийн тайлбарлах аргуудыг ашиглан хар хайрцаг загваруудын шийдвэрийг ойлгомжтой болгох судалгаа явуулж болно. Энэ нь багш нар, эцэг эхчүүд загварын үр дүнд илүү итгэх, зөв ашиглахад тусална.

**Интервенцийн судалгаа:** Загварын үр дүнд үндэслэн бодит хөтөлбөр хэрэгжүүлж (жишээ нь эрсдэлтэй оюутнуудад нэмэлт дэмжлэг үзүүлэх), энэ нь үнэхээр сурлагын үр дүнг сайжруулж байгаа эсэхийг хянах туршилт судалгаа хийх хэрэгтэй. Энэ нь загварын практик үр өгөөжийг баталгаажуулна.

# Багийн гишүүдийн үүрэг оролцоо

Төслийн ажилд багийн гишүүд дараах байдлаар хувь нэмэр оруулсан:

| Гишүүний нэр | Үүрэг | Хувь нэмэр |
|--------------|-------|------------|
| [Нэр 1] | | __%  |
| [Нэр 2] | | __%  |
| [Нэр 3] | | __%  |
| [Нэр 4] | | __%  |
| [Нэр 5] | | __%  |

**Тэмдэглэл:** Бүх багийн гишүүд идэвхтэй оролцож, хамтран ажилласан.

# Ашигласан материал {.unnumbered}

::: {#refs}
:::